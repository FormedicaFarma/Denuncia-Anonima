<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canal de Den√∫ncias An√¥nimas - Form√©dica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        /* O CSS foi mantido inalterado */
        
        /* Cores de Destaque */
        :root {
            --cor-principal: #416BA7; /* Azul Principal */
            --cor-secundaria: #345587; /* Azul escuro para hover */
            --cor-fundo-suave: #e6eef8; /* Fundo suave, levemente azulado */
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            margin-top: 30px;
            position: relative;
        }

        /* Cont√™iner para posicionar o bot√£o de pol√≠tica */
        .header-policy-wrapper {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 50;
        }
        
        /* Novo estilo para o bot√£o de pol√≠tica (pequeno, no canto) */
        .btn-header-policy {
            background-color: transparent;
            color: var(--cor-principal);
            border: 1px solid var(--cor-principal);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: background-color 0.3s, color 0.3s;
            white-space: nowrap;
        }
        .btn-header-policy:hover {
            background-color: var(--cor-principal);
            color: white;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-top: 30px;
        }

        /* Aten√ß√£o: Verifique se este caminho da imagem est√° correto. */
        .logo {
            max-width: 250px;
            height: auto;
            margin: 0 auto 15px auto;
            display: block;
        }

        h1 {
            color: #2c3e50;
            font-weight: 700;
            font-size: 2em;
            border-bottom: 3px solid var(--cor-principal);
            padding-bottom: 10px;
            display: inline-block;
        }

        .intro-text, .section-title {
            margin-bottom: 20px;
            padding: 15px;
            border-left: 5px solid var(--cor-principal);
            background-color: var(--cor-fundo-suave);
            border-radius: 4px;
        }

        .intro-text p {
            margin: 0 0 10px 0;
        }

        .intro-text ul {
            list-style-type: 'üëâ';
            padding-left: 20px;
        }

        .intro-text li {
            padding-left: 10px;
            margin-bottom: 5px;
        }
        
        .anonymous-note {
            background-color: #fffae0;
            border: 1px solid #ffcc00;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-style: italic;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #2c3e50;
        }

        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        textarea:focus,
        select:focus {
            border-color: var(--cor-principal);
            outline: none;
            box-shadow: 0 0 5px rgba(65, 107, 167, 0.5);
        }

        textarea {
            resize: vertical;
            min-height: 150px;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .checkbox-item {
            margin-bottom: 10px;
            flex: 1 1 45%;
        }
        
        .checkbox-group label {
            font-weight: 400;
            margin-bottom: 0;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"],
        .checkbox-group input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
            flex-shrink: 0; 
        }

        /* Estilo para o bot√£o de envio */
        button[type="submit"] {
            background-color: var(--cor-principal);
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 700;
            transition: background-color 0.3s, transform 0.1s;
            width: 100%;
        }

        button[type="submit"]:hover:not(:disabled) {
            background-color: var(--cor-secundaria);
        }
        
        button[type="submit"]:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        button[type="submit"]:active:not(:disabled) {
            transform: scale(0.99);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            font-size: 0.9em;
            color: #777;
        }

        .disclaimer {
            background-color: #f4f7f6;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            border: 1px dashed #ccc;
        }
        
        /* ------------------ ESTILOS GERAIS DA JANELA MODAL ------------------ */

        /* Fundo escuro que cobre toda a tela */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.7);
            padding-top: 60px;
        }

        /* Conte√∫do da Modal de Agradecimento (menor e centralizada) */
        #successModal .modal-content-small {
            background-color: #fefefe;
            margin: 15% auto; /* Centraliza mais no meio da tela */
            padding: 30px;
            border: 1px solid #888;
            width: 90%; 
            max-width: 500px; /* Largura pequena */
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        #successModal h2 {
            color: var(--cor-principal);
            margin-top: 0;
            font-size: 1.8em;
        }
        #successModal .icon-check {
            font-size: 4em;
            color: #28a745; /* Verde de sucesso */
            margin-bottom: 10px;
            display: block;
        }

        /* Conte√∫do da Modal de Pol√≠tica (grande) */
        #policyModal .modal-content-large {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%; 
            max-width: 1000px;
            border-radius: 8px;
            position: relative;
            height: 90vh;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        /* Bot√£o para fechar a modal de pol√≠tica */
        .close {
            color: #aaa;
            float: right;
            font-size: 35px;
            font-weight: bold;
            line-height: 1;
            margin-left: auto;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }
        .modal-header h2 {
            margin: 0;
            color: var(--cor-principal);
            font-size: 1.5em;
        }

        /* Iframe para carregar o PDF/Pol√≠tica */
        .policy-viewer {
            flex-grow: 1;
            border: 1px solid #ccc;
            width: 100%;
            overflow: hidden;
        }


        /* Responsividade b√°sica */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            #policyModal .modal-content-large {
                width: 95%; 
                margin: 10px auto;
                height: 95vh;
            }
            #successModal .modal-content-small {
                margin: 40% auto;
            }
            .header-policy-wrapper {
                top: 10px; 
                right: 10px; 
            }
            .checkbox-item {
                flex: 1 1 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-policy-wrapper">
            <button class="btn-header-policy" id="openPolicyBtn">
                Pol√≠tica do Canal de Den√∫ncias
            </button>
        </div>
        <header>
            <img src="Logo - Formedica - Horizontal.png" alt="Form√©dica Logo" class="logo">
            <h1>Canal de Den√∫ncias An√¥nimas</h1>
        </header>

        <div class="intro-text">
            <p>Este formul√°rio √© um canal exclusivo e seguro para que voc√™ possa relatar, de forma an√¥nima e confidencial, qualquer situa√ß√£o que viole princ√≠pios √©ticos, legais ou as diretrizes da empresa.</p>
            <p>Voc√™ pode utilizar este espa√ßo para reportar, por exemplo:</p>
            <ul>
                <li>Ass√©dio moral ou sexual</li>
                <li>Discrimina√ß√£o</li>
                <li>Irregularidades financeiras</li>
                <li>Abusos de autoridade</li>
                <li>Condutas inadequadas no ambiente de trabalho</li>
            </ul>
        </div>
        
        <div class="anonymous-note">
            <label>üîí Anonimato garantido:</label>
            <p>Este formul√°rio n√£o registra e-mails, nomes ou endere√ßos IP. Sua identidade estar√° completamente protegida.</p>
        </div>
        
        <div class="intro-text disclaimer">
             <label>üí¨ Importante:</label>
             <p>Descreva a situa√ß√£o com o m√°ximo de detalhes poss√≠veis (data, local, pessoas envolvidas, etc.) para facilitar a an√°lise e a tomada de provid√™ncias. Todas as den√∫ncias ser√£o avaliadas com responsabilidade, imparcialidade e sigilo.</p>
             <p>A sua voz √© fundamental para um ambiente mais √©tico, seguro e respeitoso. Denuncie com confian√ßa. Aqui, voc√™ ser√° ouvido.</p>
        </div>


        <form id="denunciaForm">
            <div class="form-group">
                <label for="sede">Qual a sua sede? *</label>
                <select id="sede" name="sede" required>
                    <option value="">Selecione...</option>
                    <option value="matriz">Matriz - Batel</option>
                    <option value="sede2">Sede 2 - Santa Quit√©ria</option>
                </select>
            </div>

            <div class="form-group">
                <label for="local_ocorrido">Local do Ocorrido *</label>
                <select id="local_ocorrido" name="local_ocorrido" required>
                    <option value="">Selecione...</option>
                    <option value="matriz">Matriz - Batel</option>
                    <option value="sede2">Sede 2 - Santa Quit√©ria</option>
                </select>
            </div>

            <div class="form-group">
                <label>Qual √© o tipo de situa√ß√£o que voc√™ deseja relatar? (Pode selecionar mais de uma) *</label>
                <div class="checkbox-group">
                    <div class="checkbox-item"><input type="checkbox" id="tipo1" name="tipo[]" value="Ass√©dio moral"><label for="tipo1">Ass√©dio moral</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo2" name="tipo[]" value="Ass√©dio sexual"><label for="tipo2">Ass√©dio sexual</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo3" name="tipo[]" value="Discrimina√ß√£o"><label for="tipo3">Discrimina√ß√£o (ra√ßa, g√™nero, orienta√ß√£o sexual etc.)</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo4" name="tipo[]" value="Corrup√ß√£o ou fraude"><label for="tipo4">Corrup√ß√£o ou fraude</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo5" name="tipo[]" value="Desvio de conduta √©tica"><label for="tipo5">Desvio de conduta √©tica</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo6" name="tipo[]" value="Abuso de autoridade"><label for="tipo6">Abuso de autoridade</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo7" name="tipo[]" value="Irregularidade trabalhista"><label for="tipo7">Irregularidade trabalhista</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo8" name="tipo[]" value="Uso indevido de recursos da empresa"><label for="tipo8">Uso indevido de recursos da empresa</label></div>
                    <div class="checkbox-item"><input type="checkbox" id="tipo9_outro" name="tipo[]" value="Outro"><label for="tipo9_outro">Outro</label></div>
                </div>
                <div class="form-group" id="outroTipoField" style="display:none; margin-top: 15px;">
                    <label for="outro_tipo">Qual tipo de situa√ß√£o?</label>
                    <input type="text" id="outro_tipo" name="outro_tipo" placeholder="Descreva o tipo de situa√ß√£o.">
                </div>
            </div>

            <div class="form-group">
                <label for="quando">Quando a situa√ß√£o ocorreu? (Data aproximada ou per√≠odo) *</label>
                <input type="text" id="quando" name="quando" placeholder="Ex: Mar√ßo de 2025; Semana passada; Dia 15/05/2025" required>
            </div>

            <div class="form-group">
                <label for="onde">Onde a situa√ß√£o aconteceu? (Setor, local f√≠sico ou evento, por exemplo) *</label>
                <input type="text" id="onde" name="onde" placeholder="Ex: Setor Financeiro; Cozinha da Matriz; Evento de confraterniza√ß√£o" required>
            </div>

            <div class="form-group">
                <label for="quem">Quem est√° envolvido na situa√ß√£o? (Cargos, nomes, √°reas, ou qualquer identifica√ß√£o poss√≠vel) *</label>
                <input type="text" id="quem" name="quem" placeholder="Ex: O gerente da √°rea comercial; A secret√°ria do setor X; O colega Jo√£o" required>
            </div>

            <div class="form-group">
                <label for="descricao">Descreva a situa√ß√£o com o m√°ximo de detalhes que puder. (O que aconteceu, como, com quem, consequ√™ncias) *</label>
                <textarea id="descricao" name="descricao" required placeholder="Forne√ßa o m√°ximo de informa√ß√µes poss√≠veis para que possamos investigar. Seja claro e objetivo."></textarea>
            </div>

            <div class="form-group">
                <label>A situa√ß√£o ainda est√° ocorrendo? *</label>
                <div class="checkbox-group">
                    <div class="checkbox-item"><input type="radio" id="frequencia1" name="frequencia" value="Sim, est√° acontecendo neste momento" required><label for="frequencia1">Sim, est√° acontecendo neste momento</label></div>
                    <div class="checkbox-item"><input type="radio" id="frequencia2" name="frequencia" value="N√£o, j√° aconteceu e parou"><label for="frequencia2">N√£o, j√° aconteceu e parou</label></div>
                    <div class="checkbox-item"><input type="radio" id="frequencia3" name="frequencia" value="Acontece com frequ√™ncia"><label for="frequencia3">Acontece com frequ√™ncia</label></div>
                    <div class="checkbox-item"><input type="radio" id="frequencia4" name="frequencia" value="N√£o tenho certeza"><label for="frequencia4">N√£o tenho certeza</label></div>
                </div>
            </div>

            <div class="form-group">
                <label for="whatsapp">Informe o seu Whatsapp para darmos um retorno sobre o caso: (Opcional)</label>
                <input type="text" id="whatsapp" name="whatsapp" placeholder="(xx) xxxxx-xxxx">
            </div>

            <div class="form-group">
                <label for="comentario_final">Deseja deixar alguma recomenda√ß√£o ou coment√°rio final? (Opcional)</label>
                <textarea id="comentario_final" name="comentario_final" placeholder="Alguma observa√ß√£o adicional, sugest√£o de melhoria ou preocupa√ß√£o."></textarea>
            </div>

            <button type="submit">Enviar Den√∫ncia de Forma An√¥nima</button>
        </form>

        <footer>
            <p>Atenciosamente,</p>
            <p>Equipe CIPA 2025/2026</p>
            <p>Sua identidade √© nossa prioridade. Todos os dados s√£o tratados com o mais absoluto sigilo.</p>
        </footer>
    </div>

    <div id="successModal" class="modal">
        <div class="modal-content-small">
            <span class="icon-check">‚úÖ</span>
            <h2>Den√∫ncia Enviada com Sucesso!</h2>
            <p>Agradecemos a sua contribui√ß√£o. Sua den√∫ncia foi registrada e ser√° analisada com a m√°xima confidencialidade e imparcialidade.</p>
            <p>Refor√ßamos: Sua identidade est√° completamente protegida. Este sistema garante o seu anonimato.</p>
            <p>Assim que possivel daremos um retorno a voc√™!</p>
            <button onclick="closeSuccessModal()" class="btn-header-policy" style="background-color: var(--cor-principal); color: white; margin-top: 15px;">Fechar</button>
        </div>
    </div>

    <div id="policyModal" class="modal">
        <div class="modal-content-large">
            <div class="modal-header">
                <h2>Pol√≠tica do Canal de Den√∫ncias Form√©dica</h2>
                <span class="close" id="closePolicyBtn">&times;</span>
            </div>
            
            <iframe id="policyIframe" class="policy-viewer" src="Politica_Canal_Denuncias_Formedica.pdf" frameborder="0">
                <p>Seu navegador n√£o suporta iframes. <a href="Politica_Canal_Denuncias_Formedica.pdf" target="_blank">Clique aqui para baixar a pol√≠tica.</a></p>
            </iframe>
        </div>
    </div>

    <script>
        // --- VARI√ÅVEIS DE DOM ---
        var policyModal = document.getElementById("policyModal");
        var openPolicyBtn = document.getElementById("openPolicyBtn");
        var closePolicyBtn = document.getElementById("closePolicyBtn");
        var successModal = document.getElementById("successModal");
        var denunciaForm = document.getElementById("denunciaForm");

        var outroCheckbox = document.getElementById('tipo9_outro');
        var outroTipoField = document.getElementById('outroTipoField');
        var outroTipoInput = document.getElementById('outro_tipo');

        // --- CONFIGURA√á√ÉO DO WEBHOOK ---
        const WEBHOOK_URL = "https://hook.us2.make.com/gw9mvjbb7lxkkqfam7dbej69fmp1emd3"; // <-- **SUBSTITUA ESTA LINHA**

        // --- L√ìGICA DAS MODAIS ---
        openPolicyBtn.onclick = function() {
          policyModal.style.display = "block";
        }
        
        closePolicyBtn.onclick = function() {
          policyModal.style.display = "none";
        }
        
        window.onclick = function(event) {
          if (event.target == policyModal) {
            policyModal.style.display = "none";
          }
        }
        
        function closeSuccessModal() {
            successModal.style.display = "none";
        }


        // --- L√ìGICA DO CAMPO DIN√ÇMICO "OUTRO" ---
        outroCheckbox.addEventListener('change', function() {
            if (this.checked) {
                outroTipoField.style.display = 'block';
                outroTipoInput.required = true;
            } else {
                outroTipoField.style.display = 'none';
                outroTipoInput.required = false;
                outroTipoInput.value = '';
            }
        });


        // --- L√ìGICA DE ENVIO VIA WEBHOOK E RESET (SEM ALERTAS DE ERRO) ---
        denunciaForm.addEventListener('submit', async function(event) {
            event.preventDefault(); 

            const formData = new FormData(denunciaForm);
            const outroTipo = formData.get('outro_tipo');
            const submitButton = document.querySelector('#denunciaForm button[type="submit"]');

            // Processamento do campo 'Outro'
            const tiposSelecionados = formData.getAll('tipo[]');
            if (tiposSelecionados.includes("Outro") && outroTipo) {
                 formData.delete('tipo[]');
                 tiposSelecionados.forEach(tipo => {
                     if(tipo === "Outro") {
                         formData.append('tipo[]', `Outro: ${outroTipo}`);
                     } else {
                         formData.append('tipo[]', tipo);
                     }
                 });
            }
            formData.delete('outro_tipo'); // Limpa o campo extra


            try {
                submitButton.disabled = true;
                submitButton.textContent = 'Enviando...';

                // Usando FormData no body sem Content-Type para evitar o preflight OPTIONS
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    body: formData
                });

                // Se o servidor retornar um status 2xx, o envio foi bem-sucedido.
                if (response.ok) { 
                    console.log('Den√∫ncia enviada com sucesso (Status 2xx).');
                    // SUCESSO: MOSTRAR MODAL E RESETAR FORM
                    denunciaForm.reset();
                    outroTipoField.style.display = 'none'; 
                    successModal.style.display = "block";
                } else {
                    // ERRO NO WEBHOOK (status 4xx ou 5xx). Logamos o erro, mas for√ßamos o sucesso no frontend.
                    console.error('Webhook falhou (c√≥digo de erro HTTP):', response.status, response.statusText);
                    // For√ßar o sucesso do frontend para garantir o anonimato e a experi√™ncia do usu√°rio
                    denunciaForm.reset();
                    outroTipoField.style.display = 'none';
                    successModal.style.display = "block";
                }

            } catch (error) {
                // ERRO DE REDE/CONEX√ÉO. Logamos o erro, mas for√ßamos o sucesso no frontend.
                console.error('Falha na requisi√ß√£o de rede. Den√∫ncia provavelmente enviada, mas sem confirma√ß√£o:', error);
                
                // For√ßamos o sucesso do frontend para garantir o anonimato e a experi√™ncia do usu√°rio
                denunciaForm.reset();
                outroTipoField.style.display = 'none';
                successModal.style.display = "block";
            } finally {
                // Reabilita o bot√£o
                submitButton.disabled = false;
                submitButton.textContent = 'Enviar Den√∫ncia de Forma An√¥nima';
            }
        });
    </script>
</body>
</html>
